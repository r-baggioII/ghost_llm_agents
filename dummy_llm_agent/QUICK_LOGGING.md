# ðŸ“ Quick Logging Guide

## Where Are My Command Logs?

**Two log files are automatically created when the agent runs:**

1. **`logs/command_history.jsonl`** - Detailed, machine-readable
2. **`logs/command_history.csv`** - Spreadsheet-friendly

## What's Logged?

Every command generated by the LLM includes:

- âœ… **Timestamp**: Exact ISO 8601 format (e.g., `2025-01-10T14:23:45.123456`)
- âœ… **NPC Name**: Who generated it (e.g., `Dr. Sarah Chen`)
- âœ… **NPC Role**: Their job (e.g., `AI Research Scientist`)
- âœ… **Command**: Full bash command executed
- âœ… **Working Directory**: Where it runs
- âœ… **Delay After**: Seconds until next command (usually 15)
- âœ… **LLM Model**: Which AI model (`gpt-4o-mini`)
- âœ… **Session ID**: Daily identifier (YYYYMMDD)

## Quick Commands

```bash
# Show statistics
./view-logs.sh stats

# View last 10 commands
./view-logs.sh recent

# View last 50 commands
./view-logs.sh recent 50

# Watch commands live
./view-logs.sh tail

# View commands by specific NPC
./view-logs.sh npc "Dr. Sarah Chen"

# Export to readable text file
./view-logs.sh export

# View CSV (tabular)
./view-logs.sh csv
```

## Example Log Entry

### JSONL Format (`command_history.jsonl`):
```json
{
  "timestamp": "2025-01-10T14:23:45.123456",
  "npc_name": "Dr. Sarah Chen",
  "npc_role": "AI Research Scientist",
  "command": "cd /home/rocio/Documentos/GHOSTS/dummy_llm_agent/workspace && ls -la",
  "working_directory": "/home/rocio/Documentos/GHOSTS/dummy_llm_agent/workspace",
  "delay_after": 15,
  "llm_model": "gpt-4o-mini",
  "session_id": "20250110"
}
```

### CSV Format (`command_history.csv`):
```csv
timestamp,npc_name,npc_role,command,working_directory,delay_after,llm_model,session_id
2025-01-10T14:23:45.123456,Dr. Sarah Chen,AI Research Scientist,"cd ... && ls -la",/path/to/workspace,15,gpt-4o-mini,20250110
```

## Calculate Time Between Commands

### Simple Method (View Logs)
```bash
./view-logs.sh recent 20
```
Each entry shows exact timestamp - you can manually calculate differences.

### Python Script
```python
import json
from datetime import datetime

commands = []
with open('logs/command_history.jsonl', 'r') as f:
    for line in f:
        commands.append(json.loads(line))

for i in range(1, len(commands)):
    prev_time = datetime.fromisoformat(commands[i-1]['timestamp'])
    curr_time = datetime.fromisoformat(commands[i]['timestamp'])
    delta = (curr_time - prev_time).total_seconds()
    
    print(f"â±ï¸  {delta:.1f}s between commands")
    print(f"ðŸ“… {commands[i]['timestamp']}")
    print(f"ðŸ’» {commands[i]['command']}")
    print()
```

### Using jq (Command-Line)
```bash
# Extract all timestamps
jq -r '.timestamp' logs/command_history.jsonl

# Get commands with timestamps
jq -r '"\(.timestamp) | \(.command)"' logs/command_history.jsonl
```

## View in Excel/LibreOffice

```bash
# Open CSV directly
libreoffice logs/command_history.csv

# Or
excel logs/command_history.csv
```

## Search for Specific Commands

```bash
# Find all file operations
jq 'select(.command | test("touch|mkdir|rm"))' logs/command_history.jsonl

# Find commands in last hour
HOUR_AGO=$(date -u -d '1 hour ago' --iso-8601=seconds)
jq --arg since "$HOUR_AGO" 'select(.timestamp > $since)' logs/command_history.jsonl

# Count total commands
wc -l logs/command_history.jsonl
```

## When Do Logs Get Created?

Logs are created **immediately** when:
1. LLM service starts successfully
2. First command is generated
3. Agent makes its first API call to `/next-command`

## Two Types of Logs

### 1. Command Generation Logs (What We Just Created)
- **Location**: `logs/command_history.{jsonl,csv}`
- **What**: Commands the AI **generates**
- **When**: Every ~15 seconds

### 2. Command Execution Logs (GHOSTS Client)
- **Location**: `bin/logs/app.log`
- **What**: Commands actually **executed** by GHOSTS
- **When**: When commands run

**To see execution logs:**
```bash
tail -f bin/logs/app.log
```

## Troubleshooting

**No logs yet?**
1. Start the LLM service: `./start-llm-service.sh`
2. Run the agent: `./run-agent.sh`
3. Wait 15 seconds for first command
4. Check: `./view-logs.sh stats`

**Permission issues?**
```bash
chmod +x view-logs.sh
chmod -R u+w logs/
```

**Want more details?**
- See [LOGGING.md](LOGGING.md) for advanced analysis
- See [LOGS_REFERENCE.md](LOGS_REFERENCE.md) for complete reference

---

**That's it!** Your command history is automatically tracked. Just run the agent and check the logs.
